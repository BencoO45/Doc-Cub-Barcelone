{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"linux/commandes-base/","title":"Commandes base","text":"<p># SOMMAIRE  {#sommaire}</p> <p>SOMMAIRE    2</p> <p>1. Installation de FreePBX 17  3</p> <p>1.1 Pr\u00e9requis 3</p> <p>1.2  Configurer FreePBX !    4</p> <p>2 . Migration vers freePBX 17   7</p> <p>2.1 pr\u00e9requis pour une migration.   7</p> <p>2.2 Sauvegarde du syst\u00e8me FreePBX 16    7</p> <p>2.3 Restauration de la sauvegarde   8</p> <p>2.4 V\u00e9rifications post-migration  9</p> <p>## 1.1 Pr\u00e9requis  {#1.1-pr\u00e9requis}</p> <p>Pour l\u2019installation de FreePBX 17 il nous faut une machine virtuelle avec debian 12 d\u2019installer \u2192 tuto ici </p> <p>1.Installation de freePBX 17 : </p> <p>Gr\u00e2ce \u00e0 un script que nous fournis Sangoma, l\u2019installation sera facilit\u00e9 ( vraiment grandement )   Il y a aura seulement 3 commandes \u00e0 saisir :</p> <p>cd /tmp  wget https://github.com/FreePBX/sng_freepbx_debian_install/raw/master/sng_freepbx_debian_install.sh -O /tmp/sng_freepbx_debian_install.sh  bash /tmp/sng_freepbx_debian_install.sh</p> <p>Le script prend environ 30 minutes pour i</p> <p>Et concr\u00e8tement que fait le script exactement ?</p> <p>Le script d\u2019installation effectue les actions suivantes :</p> <ol> <li>Ajoute les d\u00e9p\u00f4ts Sangoma permettant de t\u00e9l\u00e9charger, installer et maintenir \u00e0 jour FreePBX ;  </li> <li>Installe les paquets n\u00e9cessaires au fonctionnement de FreePBX ;</li> </ol> <p>Une fois l\u2019installation termin\u00e9e, il nous reste \u00e0 basculer sur l\u2019interface web de FreePBX afin de le configurer.</p> <p>## 1.2  Configurer FreePBX ! {#1.2-configurer-freepbx-!}</p> <p>Apr\u00e8s l\u2019installation acc\u00e9der \u00e0 l\u2019interface web depuis votre PC dans la barre de recherche :  http://ADRESSE_IP ( c\u2019est l\u2019adresse IP de votre VM, dans mon cas j\u2019ai mit http://10.33.45.140 ) </p> <p>Lors de la premi\u00e8re connexion \u00e0 l\u2019interface web de FreePBX, il sera n\u00e9cessaire de renseigner un certain nombre d\u2019informations afin de finaliser la configuration initiale.</p> <p>Nous devons notamment renseigner les \u00e9l\u00e9ments suivants :</p> <ul> <li>Username : le nom d\u2019utilisateur pour le compte administrateur. Il est diff\u00e9rent des comptes syst\u00e8mes configur\u00e9s pr\u00e9c\u00e9demment (root et le compte cr\u00e9\u00e9 lors de l\u2019installation de Debian) qui ne permettent que de se connecter \u00e0 la console (pas \u00e0 l\u2019interface web).  </li> <li>Password : le mot de passe.  </li> <li>Notifications Email address : l\u2019adresse e-mail associ\u00e9e au compte administrateur. Cette adresse e-mail sera utilis\u00e9e pour recevoir les notifications de FreePBX.  </li> <li>System Identifier : le nom de notre serveur FreePBX.  </li> <li>Automatic Module Updates : permet de d\u00e9finir quel comportement doit adopter FreePBX lorsque des mises \u00e0 jour sont disponibles. 3 choix sont possibles :  </li> <li>Enabled \\= les modules sont mis \u00e0 jour automatiquement \u00e0 la fr\u00e9quence d\u00e9finie juste apr\u00e8s ;  </li> <li>Email Only \\= envoi une notification par e-mail d\u00e8s qu\u2019une mise \u00e0 jour d\u2019un module est disponible ;  </li> <li>Disabled \\= le syst\u00e8me ne v\u00e9rifiera pas automatiquement si des mises \u00e0 jour des modules sont disponibles.  </li> <li>Send Security Emails For Unsigned Modules : envoie une notification par e-mail lorsque l\u2019on tente d\u2019installer un module qui n\u2019est pas sign\u00e9. Sauf si vous savez ce que vous fa\u00eetes, nous vous conseillons de laisser coch\u00e9 \u00ab Enabled \u00bb .  </li> <li>Check for Updates every : la fr\u00e9quence de v\u00e9rification des mises \u00e0 jour. Dans notre exemple ci-dessous, ce sera tous les samedis entre 08h et midi.</li> </ul> <p># </p> <p>Il reste \u00e0 cliquer sur \u00ab Setup System \u00bb pour enregistrer la configuration.</p> <p>\u00c0 ce stade, l\u2019installation et la configuration initiale sont termin\u00e9es.</p> <p>On a la possibilit\u00e9 d\u2019activer notre installation de FreePBX. Cette activation est optionnelle, mais fortement recommand\u00e9e. L\u2019activation est n\u00e9cessaire pour avoir acc\u00e8s \u00e0 certains outils d\u2019administration et pour installer des modules par la suite.</p> <p></p> <p>Nous pouvons passer cette \u00e9tape (en cliquant sur le bouton \u00ab Skip \u00bb ) et activer notre installation plus tard.</p> <p>Cependant, je vous recommande fortement d\u2019activer son serveur FreePBX. Gr\u00e2ce \u00e0 une documentation tr\u00e8s bien d\u00e9tailler cela est vraiment rapide : </p> <pre><code>                                       [\u2192 enregistrer son serveur freePBX](https://boxip.fr/doc/enregistrer-son-serveur-freepbx/)\n</code></pre> <p>Dernier \u00e9l\u00e9ment, FreePBX propose de t\u00e9l\u00e9charger les voix dans la langue de notre choix et de choisir la langue de l\u2019interface web. Nous recommandons de conserver l\u2019anglais pour le choix de la langue syst\u00e8me car les traductions fran\u00e7aises ne sont que partielles.</p> <p></p> <p>Enfin, nous avons la possibilit\u00e9 de suivre l'assistant permettant de configurer le pare-feu int\u00e9gr\u00e9 \u00e0 FreePBX.</p> <p>Nous ne rentrons pas dans le d\u00e9tail ici, voici une doc compl\u00e8te que j\u2019ai trouver qui vous guide dessus : </p> <pre><code>                                    [\u2192 S\u00e9curiser son serveur FreePBX](https://boxip.fr/doc/securiser-son-serveur-freepbx/)\n</code></pre> <p></p> <p>Nous avons d\u00e9sormais une installation fonctionnelle de FreePBX 17 on peut maintenant d\u00e9marrer la configuration de notre syst\u00e8me t\u00e9l\u00e9phonique \ud83d\ude42</p> <p># 2 . Migration vers freePBX 17 {#2-.-migration-vers-freepbx-17}</p> <p>## 2.1 pr\u00e9requis pour une migration.  {#2.1-pr\u00e9requis-pour-une-migration.}</p> <p>Le seul pr\u00e9requis pour pouvoir passer de FreePBX 16 \u00e0 FreePBX 17 est de disposer d\u2019une plage de maintenance suffisante. En effet, la migration vers FreePBX17 entra\u00eenera obligatoirement une interruption de services pour les utilisateurs.</p> <p>Si l\u2019on dispose d\u00e9j\u00e0 d\u2019un serveur FreePBX 17 install\u00e9, il faut compter environ 20 \u00e0 30 minutes de temps de migration.</p> <p>Si l\u2019on part de z\u00e9ro, il faudra plut\u00f4t compter une bonne heure de travail.</p> <p>## 2.2 Sauvegarde du syst\u00e8me FreePBX 16 {#2.2-sauvegarde-du-syst\u00e8me-freepbx-16}</p> <p>La toute premi\u00e8re \u00e9tape est de cr\u00e9er une sauvegarde compl\u00e8te de notre syst\u00e8me actuel.</p> <p>Se connecter sur l\u2019interface web d\u2019administration de FreePBX et se rendre dans le menu Admin &gt; Backup &amp; Restore : </p> <p>Si l\u2019on dispose d\u00e9j\u00e0 d\u2019un protocole de sauvegarde, il suffit de le lancer en cliquant sur l\u2019ic\u00f4ne associ\u00e9e.</p> <p>Autrement, cliquez sur le bouton + Add Backup.</p> <p>Les champs \u00e0 compl\u00e9ter sont les suivants :</p> <ul> <li>Backup Name : le nom que l\u2019on souhaite donner \u00e0 notre sauvegarde  </li> <li>Backup Items : conserver les choix par d\u00e9faut ; ainsi toute la configuration de FreePBX sera sauvegard\u00e9e  </li> <li>Storage Location : choisir l\u2019emplacement de sauvegarde ; \u00ab Local backup storage \u00bb par d\u00e9faut</li> </ul> <p>Il ne nous reste plus qu\u2019\u00e0 lancer une sauvegarde en cliquant sur le bouton associ\u00e9 :</p> <p></p> <p>Une fois la sauvegarde termin\u00e9e, se rendre sur l\u2019onglet Restore, puis t\u00e9l\u00e9charger la sauvegarde :</p> <p></p> <p>## </p> <p>## </p> <p>## </p> <p>## </p> <p>## </p> <p>## </p> <p>## 2.3 Restauration de la sauvegarde {#2.3-restauration-de-la-sauvegarde}</p> <p>Notre nouveau serveur est pr\u00eat \u00e0 recevoir notre sauvegarde.</p> <p>Se rendre dans le menu Admin &gt; Backup &amp; Restore :</p> <p></p> <p>Cliquer sur l\u2019onglet Restore et t\u00e9l\u00e9verser la sauvegarde :</p> <p></p> <p>Nous obtenons un message d\u2019alerte nous pr\u00e9venant des limites de la restauration :</p> <p></p> <p>Finalement cliquer sur le bouton Run Restore se situant en bas \u00e0 droite :</p> <p>Pour les d\u00e9tailles concernant ces mises en garde :  ce message est NORMAL et ATTENDU lors d\u2019une migration FreePBX 16 \u2192 17.  Notre nouvelle VM FreePBX 17 utilise Asterisk 18 ou 20 alors que chan_sip est supprim\u00e9 dans ces versions, certaines extensions de l\u2019ancienne config FreePBX 16 utilisent encore chan_sip   Asterisk refuse donc de restaurer ces \u00e9l\u00e9ments. </p> <p>Cela veux dire que FreePBX 17 n\u2019accepte plus l'extension chan_sip mais plus que pjsip</p> <p>## 2.4 V\u00e9rifications post-migration {#2.4-v\u00e9rifications-post-migration}</p> <p>La migration est termin\u00e9e, tout devrait fonctionner correctement.</p> <p>Cependant, plusieurs points sont \u00e0 v\u00e9rifier encore..</p> <p>Red\u00e9marrer le serveur : ce n\u2019est pas obligatoire, mais nous avons d\u00e9j\u00e0 remarqu\u00e9 que les param\u00e8tres du firewall de FreePBX \u00e9taient parfois mal charg\u00e9s \u00e0 l\u2019issue d\u2019une restauration ; un red\u00e9marrage du serveur permet de corriger le probl\u00e8me. De m\u00eame si les ports SIP ont \u00e9t\u00e9 personnalis\u00e9s, le red\u00e9marrage permettra de prendre en compte ce changement.</p> <p>V\u00e9rifier que les comptes SIP sont bien enregistr\u00e9s : il suffit de se rendre dans la menu Reports &gt; Asterisk Info afin de voir si tous les comptes SIP remontent correctement.</p>"},{"location":"linux/commandes-base/#installation-de-freepbx-17-installation-de-freepbx-17","title":"Installation de FreePBX 17 {#installation-de-freepbx-17}","text":""}]}